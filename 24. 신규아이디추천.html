<!DOCTYPE html>
<html lang="en">
  <head>
    <title>신규 아이디 추천</title>
    <script>
      function solution(new_id) {
        let answer = "";
        let answerMap;
        let answerfilter;
        // 2단계 특수문자 제거
        let reg = /[\{\}\[\]\/?,;:|\)*~`!^\+<>@\#$%&\\\=\(\'\"]/gi;
        new_id = new_id.replace(reg, "");
        new_id = new_id.split("");

        // 1단계 소문자 치환
        answerMap = new_id.map((string) => string.toLowerCase());

        // 3단계 . 한개 놔두기
        for (i = answerMap.length - 1; i >= 0; i--) {
          if (new_id[i] === "." && new_id[i - 1] === ".") {
            answerMap.splice(i, 1);
          }
        }

        // 4단계 . 앞뒤 지우기
        if (answerMap[answerMap.length - 1] === ".") {
          answerMap.splice(answerMap.length - 1, 1);
        }
        if (answerMap[0] === ".") {
          answerMap.splice(0, 1);
        }

        // 5단계 빈 문자열이라면, new_id에 a 대입
        if (answerMap.length === 0) {
          answerMap.push("a");
        }

        // 6단계 길이가 16자 이상이면, 뒤 제거
        if (answerMap.length >= 16) {
          answerMap.splice(15);
          if (answerMap[14] === ".") {
            answerMap.splice(answerMap.length - 1, 1);
          }
        }

        // 7단계 길이가 2자 이하라면, 마지막 문자 길이가 3 이상일 때까지 반복
        if (answerMap.length === 1) {
          answerMap.push(answerMap[0], answerMap[0]);
        }
        if (answerMap.length === 2) {
          answerMap.push(answerMap[1]);
        }

        answer = answerMap.join("");

        return answer;
      }
    </script>
  </head>
  <body></body>
</html>
